<header class="flex h-14 items-center justify-between border-b bg-gray-100/40 px-6">
    <div class="flex items-center gap-2">
        <h3 class="text-xl font-bold leading-5 text-gray-900">{{ issueType | titlecase }}</h3>
    </div>
    <div class="flex items-center gap-2">
        <app-button label="Reportar Asunto" (action)="openCreateIssueModal()">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current w-4 h-4 mr-2 text-white">
                <path
                    d="M12 9v3.75m0-10.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.75c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.57-.598-3.75h-.152c-3.196 0-6.1-1.25-8.25-3.286Zm0 13.036h.008v.008H12v-.008Z" />
            </svg>
        </app-button>
    </div>
</header>

<div class="card flex justify-content-center">
    <p-dialog [(visible)]="visible" [header]="'Reporte del asunto'" [modal]="true" [style]="{ width: '30rem' }"
        [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }" [draggable]="false" [resizable]="false">
        <h3 class="text-md font-semibold -mt-4">INFORMACION</h3>
        <span class="p-text-secondary block mb-3 leading-tight">
            Si tuviste algún problema en el transcurso de tu trabajo reportalo para que los administradores lo
            resuelvan.
        </span>
        <form [formGroup]="newIssueForm" (ngSubmit)="pushIssue()">
            <div class="mb-3">
                <label class="mb-2 block text-sm font-semibold">Título del asunto</label>
                <input pInputText formControlName="title" placeholder="El foco del auto ABC-1234 está fundido"
                    class="block w-80 rounded-md border border-gray-300 focus:border-gray-700 focus:outline-none focus:ring-1 focus:ring-gray-700 py-1 px-1.5 text-gray-500" />
            </div>
            <div class="mb-3">
                <label class="mb-2 block text-sm font-semibold">Descripción del asunto</label>
                <textarea rows="4" cols="20" pInputTextarea formControlName="description"
                    placeholder="Ayer que le cambiaron el foco al vehículo ABC-1234, el técnico no lo colocó correctamente y se fundió. Por favor, revisar y corregir."
                    class="block w-80 rounded-md border border-gray-300 focus:border-gray-700 focus:outline-none focus:ring-1 focus:ring-gray-700 py-1 px-1.5 text-gray-500">
                </textarea>
            </div>
            <div class="mb-3">
                <label class="mb-2 block text-sm font-semibold">Categoría de asuntos:</label>
                <p-dropdown formControlName="selectedIssueType" [options]="issueTypes"
                    placeholder="Selecciona un tipo de asunto">
                </p-dropdown>
            </div>
            <div class="mb-3">
                <label class="mb-2 block text-sm font-semibold">Subir evidencias</label>
                <input type="file" (change)="upload($event)" multiple class="w-full text-gray-400 font-semibold text-sm bg-white border file:cursor-pointer cursor-pointer file:border-0 file:py-3 file:px-4 file:mr-4 file:bg-gray-100 file:hover:bg-gray-200 file:text-gray-500 rounded
         pl-3" />
                <input type="hidden" formControlName="evidenceValidation">
                <p class="text-xs text-gray-400 mt-2">Puedes subir archivos PNG o JPG.</p>
                @if (uploadedFiles.length > 0) {
                <div class="mt-2">
                    <p class="mb-1 block text-sm font-semibold">Archivos subidos:</p>
                    <ul class="list-none list-inside">
                        @for (file of uploadedFiles; track $index) {
                        <li class="text-xs text-gray-600">
                            {{ file.split('/').pop() }}
                        </li>
                        }
                    </ul>
                </div>
                }
            </div>
            <div class="mb-3">
                <button
                    class="mb-1.5 block w-full text-center text-white bg-slate-700 hover:bg-slate-900 px-2 py-1.5 rounded-md"
                    [disabled]="!canSubmit">Subir reporte</button>
            </div>
        </form>
    </p-dialog>
</div>
<p-toast />